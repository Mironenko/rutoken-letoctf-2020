!function e(t,r,n){function i(o,l){if(!r[o]){if(!t[o]){var a="function"==typeof require&&require;if(!l&&a)return a(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};t[o][0].call(c.exports,(function(e){var r=t[o][1][e];return i(r||e)}),c,c.exports,e,t,r,n)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromBER=ue,r.compareSchema=ce,r.verifySchema=function(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=ue(e);if(-1===r.offset)return{verified:!1,result:r.result};return ce(r.result,r.result,t)},r.fromJSON=function(e){},r.RawData=r.Repeated=r.Any=r.Choice=r.TIME=r.Duration=r.DateTime=r.TimeOfDay=r.DATE=r.GeneralizedTime=r.UTCTime=r.CharacterString=r.GeneralString=r.VisibleString=r.GraphicString=r.IA5String=r.VideotexString=r.TeletexString=r.PrintableString=r.NumericString=r.UniversalString=r.BmpString=r.RelativeObjectIdentifier=r.Utf8String=r.ObjectIdentifier=r.Enumerated=r.Integer=r.BitString=r.OctetString=r.Null=r.Set=r.Sequence=r.Boolean=r.EndOfContent=r.Constructed=r.Primitive=r.BaseBlock=r.ValueBlock=r.HexBlock=void 0;var n=e("pvutils");const i=[new Uint8Array([1])];class s{constructor(e={}){this.blockLength=(0,n.getParametersValue)(e,"blockLength",0),this.error=(0,n.getParametersValue)(e,"error",""),this.warnings=(0,n.getParametersValue)(e,"warnings",[]),this.valueBeforeDecode="valueBeforeDecode"in e?e.valueBeforeDecode.slice(0):new ArrayBuffer(0)}static blockName(){return"baseBlock"}toJSON(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:(0,n.bufferToHexCodes)(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}const o=e=>class extends e{constructor(e={}){super(e),this.isHexOnly=(0,n.getParametersValue)(e,"isHexOnly",!1),this.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0)}static blockName(){return"hexBlock"}fromBER(e,t,r){if(!1===(0,n.checkBufferParams)(this,e,t,r))return-1;return 0===new Uint8Array(e,t,r).length?(this.warnings.push("Zero buffer length"),t):(this.valueHex=e.slice(t,t+r),this.blockLength=r,t+r)}toBER(e=!1){return!0!==this.isHexOnly?(this.error='Flag "isHexOnly" is not set, abort',new ArrayBuffer(0)):!0===e?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isHexOnly=this.isHexOnly,e.valueHex=(0,n.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}};r.HexBlock=o;class l extends(o(s)){constructor(e={}){super(),"idBlock"in e?(this.isHexOnly=(0,n.getParametersValue)(e.idBlock,"isHexOnly",!1),this.valueHex=(0,n.getParametersValue)(e.idBlock,"valueHex",new ArrayBuffer(0)),this.tagClass=(0,n.getParametersValue)(e.idBlock,"tagClass",-1),this.tagNumber=(0,n.getParametersValue)(e.idBlock,"tagNumber",-1),this.isConstructed=(0,n.getParametersValue)(e.idBlock,"isConstructed",!1)):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}static blockName(){return"identificationBlock"}toBER(e=!1){let t,r,i=0;switch(this.tagClass){case 1:i|=0;break;case 2:i|=64;break;case 3:i|=128;break;case 4:i|=192;break;default:return this.error="Unknown tag class",new ArrayBuffer(0)}if(this.isConstructed&&(i|=32),this.tagNumber<31&&!this.isHexOnly){if(t=new ArrayBuffer(1),r=new Uint8Array(t),!e){let e=this.tagNumber;e&=31,i|=e,r[0]=i}return t}if(!1===this.isHexOnly){const s=(0,n.utilToBase)(this.tagNumber,7),o=new Uint8Array(s),l=s.byteLength;if(t=new ArrayBuffer(l+1),r=new Uint8Array(t),r[0]=31|i,!e){for(let e=0;e<l-1;e++)r[e+1]=128|o[e];r[l]=o[l-1]}return t}if(t=new ArrayBuffer(this.valueHex.byteLength+1),r=new Uint8Array(t),r[0]=31|i,!1===e){const e=new Uint8Array(this.valueHex);for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHex.byteLength]=e[e.length-1]}return t}fromBER(e,t,r){if(!1===(0,n.checkBufferParams)(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);if(0===i.length)return this.error="Zero buffer length",-1;switch(192&i[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&i[0]),this.isHexOnly=!1;const s=31&i[0];if(31!==s)this.tagNumber=s,this.blockLength=1;else{let e=1;this.valueHex=new ArrayBuffer(255);let t=255,r=new Uint8Array(this.valueHex);for(;128&i[e];){if(r[e-1]=127&i[e],e++,e>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(e===t){t+=255;const e=new ArrayBuffer(t),n=new Uint8Array(e);for(let e=0;e<r.length;e++)n[e]=r[e];this.valueHex=new ArrayBuffer(t),r=new Uint8Array(this.valueHex)}}this.blockLength=e+1,r[e-1]=127&i[e];const s=new ArrayBuffer(e),o=new Uint8Array(s);for(let t=0;t<e;t++)o[t]=r[t];this.valueHex=new ArrayBuffer(e),r=new Uint8Array(this.valueHex),r.set(o),this.blockLength<=9?this.tagNumber=(0,n.utilFromBase)(r,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.tagClass=this.tagClass,e.tagNumber=this.tagNumber,e.isConstructed=this.isConstructed,e}}class a extends s{constructor(e={}){super(),"lenBlock"in e?(this.isIndefiniteForm=(0,n.getParametersValue)(e.lenBlock,"isIndefiniteForm",!1),this.longFormUsed=(0,n.getParametersValue)(e.lenBlock,"longFormUsed",!1),this.length=(0,n.getParametersValue)(e.lenBlock,"length",0)):(this.isIndefiniteForm=!1,this.longFormUsed=!1,this.length=0)}static blockName(){return"lengthBlock"}fromBER(e,t,r){if(!1===(0,n.checkBufferParams)(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);if(0===i.length)return this.error="Zero buffer length",-1;if(255===i[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===i[0],!0===this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&i[0]),!1===this.longFormUsed)return this.length=i[0],this.blockLength=1,t+this.blockLength;const s=127&i[0];if(s>8)return this.error="Too big integer",-1;if(s+1>i.length)return this.error="End of input reached before message was fully decoded",-1;const o=new Uint8Array(s);for(let e=0;e<s;e++)o[e]=i[e+1];return 0===o[s-1]&&this.warnings.push("Needlessly long encoded length"),this.length=(0,n.utilFromBase)(o,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unneccesary usage of long length form"),this.blockLength=s+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(!0===this.longFormUsed){const i=(0,n.utilToBase)(this.length,8);if(i.byteLength>127)return this.error="Too big length",new ArrayBuffer(0);if(t=new ArrayBuffer(i.byteLength+1),!0===e)return t;const s=new Uint8Array(i);r=new Uint8Array(t),r[0]=128|i.byteLength;for(let e=0;e<i.byteLength;e++)r[e+1]=s[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isIndefiniteForm=this.isIndefiniteForm,e.longFormUsed=this.longFormUsed,e.length=this.length,e}}class u extends s{constructor(e={}){super(e)}static blockName(){return"valueBlock"}fromBER(e,t,r){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}toBER(e=!1){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}}r.ValueBlock=u;class c extends s{constructor(e={},t=u){super(e),"name"in e&&(this.name=e.name),"optional"in e&&(this.optional=e.optional),"primitiveSchema"in e&&(this.primitiveSchema=e.primitiveSchema),this.idBlock=new l(e),this.lenBlock=new a(e),this.valueBlock=new t(e)}static blockName(){return"BaseBlock"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e=!1){let t;const r=this.idBlock.toBER(e),i=this.valueBlock.toBER(!0);this.lenBlock.length=i.byteLength;const s=this.lenBlock.toBER(e);let o;if(t=(0,n.utilConcatBuf)(r,s),o=!1===e?this.valueBlock.toBER(e):new ArrayBuffer(this.lenBlock.length),t=(0,n.utilConcatBuf)(t,o),!0===this.lenBlock.isIndefiniteForm){const r=new ArrayBuffer(2);if(!1===e){const e=new Uint8Array(r);e[0]=0,e[1]=0}t=(0,n.utilConcatBuf)(t,r)}return t}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.idBlock=this.idBlock.toJSON(),e.lenBlock=this.lenBlock.toJSON(),e.valueBlock=this.valueBlock.toJSON(),"name"in this&&(e.name=this.name),"optional"in this&&(e.optional=this.optional),"primitiveSchema"in this&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}}r.BaseBlock=c;class h extends u{constructor(e={}){super(e),this.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0),this.isHexOnly=(0,n.getParametersValue)(e,"isHexOnly",!0)}fromBER(e,t,r){if(!1===(0,n.checkBufferParams)(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);if(0===i.length)return this.warnings.push("Zero buffer length"),t;this.valueHex=new ArrayBuffer(i.length);const s=new Uint8Array(this.valueHex);for(let e=0;e<i.length;e++)s[e]=i[e];return this.blockLength=r,t+r}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"PrimitiveValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueHex=(0,n.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e.isHexOnly=this.isHexOnly,e}}class f extends c{constructor(e={}){super(e,h),this.idBlock.isConstructed=!1}static blockName(){return"PRIMITIVE"}}r.Primitive=f;class g extends u{constructor(e={}){super(e),this.value=(0,n.getParametersValue)(e,"value",[]),this.isIndefiniteForm=(0,n.getParametersValue)(e,"isIndefiniteForm",!1)}fromBER(e,t,r){const i=t,s=r;if(!1===(0,n.checkBufferParams)(this,e,t,r))return-1;if(0===new Uint8Array(e,t,r).length)return this.warnings.push("Zero buffer length"),t;let o=t;for(;l=this.isIndefiniteForm,a=r,(!0===l?1:a)>0;){const t=ae(e,o,r);if(-1===t.offset)return this.error=t.result.error,this.warnings.concat(t.result.warnings),-1;if(o=t.offset,this.blockLength+=t.result.blockLength,r-=t.result.blockLength,this.value.push(t.result),!0===this.isIndefiniteForm&&t.result.constructor.blockName()===m.blockName())break}var l,a;return!0===this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.blockName()===m.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=e.slice(i,i+s),o}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const i=this.value[r].toBER(e);t=(0,n.utilConcatBuf)(t,i)}return t}static blockName(){return"ConstructedValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.isIndefiniteForm=this.isIndefiniteForm,e.value=[];for(let t=0;t<this.value.length;t++)e.value.push(this.value[t].toJSON());return e}}class d extends c{constructor(e={}){super(e,g),this.idBlock.isConstructed=!0}static blockName(){return"CONSTRUCTED"}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}}r.Constructed=d;class v extends u{constructor(e={}){super(e)}fromBER(e,t,r){return t}toBER(e=!1){return new ArrayBuffer(0)}static blockName(){return"EndOfContentValueBlock"}}class m extends c{constructor(e={}){super(e,v),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}static blockName(){return"EndOfContent"}}r.EndOfContent=m;class k extends u{constructor(e={}){if(super(e),this.value=(0,n.getParametersValue)(e,"value",!1),this.isHexOnly=(0,n.getParametersValue)(e,"isHexOnly",!1),"valueHex"in e)this.valueHex=e.valueHex.slice(0);else if(this.valueHex=new ArrayBuffer(1),!0===this.value){new Uint8Array(this.valueHex)[0]=255}}fromBER(e,t,r){if(!1===(0,n.checkBufferParams)(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,this.valueHex=new ArrayBuffer(i.length);const s=new Uint8Array(this.valueHex);for(let e=0;e<i.length;e++)s[e]=i[e];return 0!==n.utilDecodeTC.call(this)?this.value=!0:this.value=!1,this.blockLength=r,t+r}toBER(e=!1){return this.valueHex}static blockName(){return"BooleanValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e.isHexOnly=this.isHexOnly,e.valueHex=(0,n.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}class B extends c{constructor(e={}){super(e,k),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}static blockName(){return"Boolean"}}r.Boolean=B;class y extends d{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}static blockName(){return"Sequence"}}r.Sequence=y;class b extends d{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}static blockName(){return"Set"}}r.Set=b;class p extends c{constructor(e={}){super(e,s),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}static blockName(){return"Null"}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e=!1){const t=new ArrayBuffer(2);if(!0===e)return t;const r=new Uint8Array(t);return r[0]=5,r[1]=0,t}}r.Null=p;class w extends(o(g)){constructor(e={}){super(e),this.isConstructed=(0,n.getParametersValue)(e,"isConstructed",!1)}fromBER(e,t,r){let n=0;if(!0===this.isConstructed){if(this.isHexOnly=!1,n=g.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===m.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==x.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e=!1){if(!0===this.isConstructed)return g.prototype.toBER.call(this,e);let t=new ArrayBuffer(this.valueHex.byteLength);return!0===e||0===this.valueHex.byteLength||(t=this.valueHex.slice(0)),t}static blockName(){return"OctetStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=(0,n.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}class x extends c{constructor(e={}){super(e,w),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r?(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t):super.fromBER(e,t,r)}static blockName(){return"OctetString"}isEqual(e){return e instanceof x!=!1&&JSON.stringify(this)===JSON.stringify(e)}}r.OctetString=x;class A extends(o(g)){constructor(e={}){super(e),this.unusedBits=(0,n.getParametersValue)(e,"unusedBits",0),this.isConstructed=(0,n.getParametersValue)(e,"isConstructed",!1),this.blockLength=this.valueHex.byteLength}fromBER(e,t,r){if(0===r)return t;let i=-1;if(!0===this.isConstructed){if(i=g.prototype.fromBER.call(this,e,t,r),-1===i)return i;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===m.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==N.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[e].valueBlock.unusedBits>0)return this.error='Usign of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[e].valueBlock.unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return i}if(!1===(0,n.checkBufferParams)(this,e,t,r))return-1;const s=new Uint8Array(e,t,r);if(this.unusedBits=s[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;this.valueHex=new ArrayBuffer(s.length-1);const o=new Uint8Array(this.valueHex);for(let e=0;e<r-1;e++)o[e]=s[e+1];return this.blockLength=s.length,t+r}toBER(e=!1){if(!0===this.isConstructed)return g.prototype.toBER.call(this,e);if(!0===e)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return new ArrayBuffer(0);const t=new Uint8Array(this.valueHex),r=new ArrayBuffer(this.valueHex.byteLength+1),n=new Uint8Array(r);n[0]=this.unusedBits;for(let e=0;e<this.valueHex.byteLength;e++)n[e+1]=t[e];return r}static blockName(){return"BitStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.unusedBits=this.unusedBits,e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=(0,n.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength),e}}class N extends c{constructor(e={}){super(e,A),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}static blockName(){return"BitString"}fromBER(e,t,r){return 0===r?t:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r))}isEqual(e){return e instanceof N!=!1&&JSON.stringify(this)===JSON.stringify(e)}}r.BitString=N;class S extends(o(u)){constructor(e={}){super(e),"value"in e&&(this.valueDec=e.value)}set valueHex(e){this._valueHex=e.slice(0),e.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,e.byteLength>0&&(this._valueDec=n.utilDecodeTC.call(this)))}get valueHex(){return this._valueHex}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this._valueHex=(0,n.utilEncodeTC)(e)}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const s=new Uint8Array(this._valueHex);if(0===s[0]&&0!=(128&s[1])){const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}else if(0!==n&&this._valueHex.byteLength<n){n-this._valueHex.byteLength>1&&(n=this._valueHex.byteLength+1);const e=new ArrayBuffer(n);new Uint8Array(e).set(s,n-this._valueHex.byteLength),this._valueHex=e.slice(0)}return i}toDER(e=!1){const t=new Uint8Array(this._valueHex);switch(!0){case 0!=(128&t[0]):{const e=new ArrayBuffer(this._valueHex.byteLength+1),r=new Uint8Array(e);r[0]=0,r.set(t,1),this._valueHex=e.slice(0)}break;case 0===t[0]&&0==(128&t[1]):{const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n?n:(this.blockLength=r,t+r)}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"IntegerValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}toString(){function e(e,t){const r=new Uint8Array([0]);let i=new Uint8Array(e),s=new Uint8Array(t),o=i.slice(0);const l=o.length-1;let a=s.slice(0);const u=a.length-1;let c=0;let h=0;for(let e=u<l?l:u;e>=0;e--,h++){switch(!0){case h<a.length:c=o[l-h]+a[u-h]+r[0];break;default:c=o[l-h]+r[0]}switch(r[0]=c/10,!0){case h>=o.length:o=(0,n.utilConcatView)(new Uint8Array([c%10]),o);break;default:o[l-h]=c%10}}return r[0]>0&&(o=(0,n.utilConcatView)(r,o)),o.slice(0)}function t(e){if(e>=i.length)for(let t=i.length;t<=e;t++){const e=new Uint8Array([0]);let r=i[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=(0,n.utilConcatView)(e,r)),i.push(r)}return i[e]}function r(e,t){let r=0,n=new Uint8Array(e),i=new Uint8Array(t),s=n.slice(0);const o=s.length-1;let l=i.slice(0);const a=l.length-1;let u,c=0;for(let e=a;e>=0;e--,c++)switch(u=s[o-c]-l[a-c]-r,!0){case u<0:r=1,s[o-c]=u+10;break;default:r=0,s[o-c]=u}if(r>0)for(let e=o-a+1;e>=0;e--,c++){if(u=s[o-c]-r,!(u<0)){r=0,s[o-c]=u;break}r=1,s[o-c]=u+10}return s.slice()}const s=8*this._valueHex.byteLength-1;let o,l=new Uint8Array(8*this._valueHex.byteLength/3),a=0;const u=new Uint8Array(this._valueHex);let c="",h=!1;for(let n=this._valueHex.byteLength-1;n>=0;n--){o=u[n];for(let n=0;n<8;n++){if(1==(1&o))switch(a){case s:l=r(t(a),l),c="-";break;default:l=e(l,t(a))}a++,o>>=1}}for(let e=0;e<l.length;e++)l[e]&&(h=!0),h&&(c+="0123456789".charAt(l[e]));return!1===h&&(c+="0123456789".charAt(0)),c}}class H extends c{constructor(e={}){super(e,S),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}static blockName(){return"Integer"}isEqual(e){return e instanceof H?this.valueBlock.isHexOnly&&e.valueBlock.isHexOnly?(0,n.isEqualBuffer)(this.valueBlock.valueHex,e.valueBlock.valueHex):this.valueBlock.isHexOnly===e.valueBlock.isHexOnly&&this.valueBlock.valueDec===e.valueBlock.valueDec:e instanceof ArrayBuffer&&(0,n.isEqualBuffer)(this.valueBlock.valueHex,e)}convertToDER(){const e=new H({valueHex:this.valueBlock.valueHex});return e.valueBlock.toDER(),e}convertFromDER(){const e=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength,t=new H({valueHex:this.valueBlock.valueHex});return t.valueBlock.fromDER(t.valueBlock.valueHex,0,t.valueBlock.valueHex.byteLength,e),t}}r.Integer=H;class C extends H{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}static blockName(){return"Enumerated"}}r.Enumerated=C;class L extends(o(s)){constructor(e={}){super(e),this.valueDec=(0,n.getParametersValue)(e,"valueDec",-1),this.isFirstSid=(0,n.getParametersValue)(e,"isFirstSid",!1)}static blockName(){return"sidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===(0,n.checkBufferParams)(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let s=new Uint8Array(this.valueHex);for(let e=0;e<r&&(s[e]=127&i[e],this.blockLength++,0!=(128&i[e]));e++);const o=new ArrayBuffer(this.blockLength),l=new Uint8Array(o);for(let e=0;e<this.blockLength;e++)l[e]=s[e];return this.valueHex=o.slice(0),s=new Uint8Array(this.valueHex),0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===s[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=(0,n.utilFromBase)(s,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const i=(0,n.utilToBase)(this.valueDec,7);if(0===i.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(i.byteLength),!1===e){const e=new Uint8Array(i);r=new Uint8Array(t);for(let t=0;t<i.byteLength-1;t++)r[t]=128|e[t];r[i.byteLength-1]=e[i.byteLength-1]}return t}toString(){let e="";if(!0===this.isHexOnly)e=(0,n.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e.isFirstSid=this.isFirstSid,e}}class O extends u{constructor(e={}){super(e),this.fromString((0,n.getParametersValue)(e,"value",""))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new L;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=(0,n.utilConcatBuf)(t,i)}return t}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return this.value=[],!1}const r=parseInt(n,10);if(isNaN(r))return!0;e.valueDec=r+t,i=!1}else{const e=new L;if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return!0;0===this.value.length&&(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e+="."),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}static blockName(){return"ObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class E extends c{constructor(e={}){super(e,O),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}static blockName(){return"ObjectIdentifier"}}r.ObjectIdentifier=E;class U extends(o(s)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"Utf8StringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class T extends c{constructor(e={}){super(e,U),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}static blockName(){return"Utf8String"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`)}}fromString(e){const t=unescape(encodeURIComponent(e)),r=t.length;this.valueBlock.valueHex=new ArrayBuffer(r);const n=new Uint8Array(this.valueBlock.valueHex);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);this.valueBlock.value=e}}r.Utf8String=T;class I extends(o(s)){constructor(e={}){super(e),this.valueDec=(0,n.getParametersValue)(e,"valueDec",-1)}static blockName(){return"relativeSidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===(0,n.checkBufferParams)(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let s=new Uint8Array(this.valueHex);for(let e=0;e<r&&(s[e]=127&i[e],this.blockLength++,0!=(128&i[e]));e++);const o=new ArrayBuffer(this.blockLength),l=new Uint8Array(o);for(let e=0;e<this.blockLength;e++)l[e]=s[e];return this.valueHex=o.slice(0),s=new Uint8Array(this.valueHex),0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===s[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=(0,n.utilFromBase)(s,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const i=(0,n.utilToBase)(this.valueDec,7);if(0===i.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(i.byteLength),!1===e){const e=new Uint8Array(i);r=new Uint8Array(t);for(let t=0;t<i.byteLength-1;t++)r[t]=128|e[t];r[i.byteLength-1]=e[i.byteLength-1]}return t}toString(){let e="";return e=!0===this.isHexOnly?(0,n.bufferToHexCodes)(this.valueHex,0,this.valueHex.byteLength):this.valueDec.toString(),e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}}class R extends u{constructor(e={}){super(e),this.fromString((0,n.getParametersValue)(e,"value",""))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new I;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const i=this.value[r].toBER(e);if(0===i.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=(0,n.utilConcatBuf)(t,i)}return t}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1;const i=new I;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e+="."),t?(n=`{${n}}`,e+=n):e+=n}return e}static blockName(){return"RelativeObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class P extends c{constructor(e={}){super(e,R),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}static blockName(){return"RelativeObjectIdentifier"}}r.RelativeObjectIdentifier=P;class _ extends(o(s)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"BmpStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class D extends c{constructor(e={}){super(e,_),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}static blockName(){return"BmpString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=2){const t=r[e];r[e]=r[e+1],r[e+1]=t}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(2*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let i=0;i<t;i++){const t=(0,n.utilToBase)(e.charCodeAt(i),8),s=new Uint8Array(t);if(s.length>2)continue;const o=2-s.length;for(let e=s.length-1;e>=0;e--)r[2*i+e+o]=s[e]}this.valueBlock.value=e}}r.BmpString=D;class F extends(o(s)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"UniversalStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class V extends c{constructor(e={}){super(e,F),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}static blockName(){return"UniversalString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(4*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let i=0;i<t;i++){const t=(0,n.utilToBase)(e.charCodeAt(i),8),s=new Uint8Array(t);if(s.length>4)continue;const o=4-s.length;for(let e=s.length-1;e>=0;e--)r[4*i+e+o]=s[e]}this.valueBlock.value=e}}r.UniversalString=V;class J extends(o(s)){constructor(e={}){super(e),this.value="",this.isHexOnly=!0}static blockName(){return"SimpleStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class j extends c{constructor(e={}){super(e,J),"value"in e&&this.fromString(e.value)}static blockName(){return"SIMPLESTRING"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}class M extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}static blockName(){return"NumericString"}}r.NumericString=M;class W extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}static blockName(){return"PrintableString"}}r.PrintableString=W;class $ extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}static blockName(){return"TeletexString"}}r.TeletexString=$;class G extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}static blockName(){return"VideotexString"}}r.VideotexString=G;class q extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}static blockName(){return"IA5String"}}r.IA5String=q;class z extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}static blockName(){return"GraphicString"}}r.GraphicString=z;class Z extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}static blockName(){return"VisibleString"}}r.VisibleString=Z;class Y extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}static blockName(){return"GeneralString"}}r.GeneralString=Y;class K extends j{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}static blockName(){return"CharacterString"}}r.CharacterString=K;class X extends Z{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,"value"in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}"valueDate"in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for convertion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(){const e=new Array(7);return e[0]=(0,n.padNumber)(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=(0,n.padNumber)(this.month,2),e[2]=(0,n.padNumber)(this.day,2),e[3]=(0,n.padNumber)(this.hour,2),e[4]=(0,n.padNumber)(this.minute,2),e[5]=(0,n.padNumber)(this.second,2),e[6]="Z",e.join("")}static blockName(){return"UTCTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e}}r.UTCTime=X;class Q extends Z{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,this.millisecond=0,"value"in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}"valueDate"in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",s=0,o=0,l=0;if("Z"===e[e.length-1])n=e.substr(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for convertion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for convertion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for convertion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substr(t+1),n=n.substr(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for convertion");let i=new Number(r.substr(0,2));if(isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");if(o=e*i,4===r.length){if(i=new Number(r.substr(2,2)),isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");l=e*i}}}let a=n.indexOf(".");if(-1===a&&(a=n.indexOf(",")),-1!==a){const e=new Number("0"+n.substr(a));if(isNaN(e.valueOf()))throw new Error("Wrong input string for convertion");s=e.valueOf(),i=n.substr(0,a)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==a)throw new Error("Wrong input string for convertion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==a){let e=60*s;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==a){let e=60*s;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==a){const e=1e3*s;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for convertion")}const u=t.exec(i);if(null===u)throw new Error("Wrong input string for convertion");for(let e=1;e<u.length;e++)switch(e){case 1:this.year=parseInt(u[e],10);break;case 2:this.month=parseInt(u[e],10);break;case 3:this.day=parseInt(u[e],10);break;case 4:this.hour=parseInt(u[e],10)+o;break;case 5:this.minute=parseInt(u[e],10)+l;break;case 6:this.second=parseInt(u[e],10);break;default:throw new Error("Wrong input string for convertion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(){const e=[];return e.push((0,n.padNumber)(this.year,4)),e.push((0,n.padNumber)(this.month,2)),e.push((0,n.padNumber)(this.day,2)),e.push((0,n.padNumber)(this.hour,2)),e.push((0,n.padNumber)(this.minute,2)),e.push((0,n.padNumber)(this.second,2)),0!==this.millisecond&&(e.push("."),e.push((0,n.padNumber)(this.millisecond,3))),e.push("Z"),e.join("")}static blockName(){return"GeneralizedTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e.millisecond=this.millisecond,e}}r.GeneralizedTime=Q;class ee extends T{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}static blockName(){return"DATE"}}r.DATE=ee;class te extends T{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}static blockName(){return"TimeOfDay"}}r.TimeOfDay=te;class re extends T{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}static blockName(){return"DateTime"}}r.DateTime=re;class ne extends T{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}static blockName(){return"Duration"}}r.Duration=ne;class ie extends T{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}static blockName(){return"TIME"}}r.TIME=ie;class se{constructor(e={}){this.value=(0,n.getParametersValue)(e,"value",[]),this.optional=(0,n.getParametersValue)(e,"optional",!1)}}r.Choice=se;class oe{constructor(e={}){this.name=(0,n.getParametersValue)(e,"name",""),this.optional=(0,n.getParametersValue)(e,"optional",!1)}}r.Any=oe;class le{constructor(e={}){this.name=(0,n.getParametersValue)(e,"name",""),this.optional=(0,n.getParametersValue)(e,"optional",!1),this.value=(0,n.getParametersValue)(e,"value",new oe),this.local=(0,n.getParametersValue)(e,"local",!1)}}r.Repeated=le;function ae(e,t,r){const i=t;let o=new c({},Object);const l=new s;if(!1===(0,n.checkBufferParams)(l,e,t,r))return o.error=l.error,{offset:-1,result:o};if(0===new Uint8Array(e,t,r).length)return this.error="Zero buffer length",{offset:-1,result:o};let a=o.idBlock.fromBER(e,t,r);if(o.warnings.concat(o.idBlock.warnings),-1===a)return o.error=o.idBlock.error,{offset:-1,result:o};if(t=a,r-=o.idBlock.blockLength,a=o.lenBlock.fromBER(e,t,r),o.warnings.concat(o.lenBlock.warnings),-1===a)return o.error=o.lenBlock.error,{offset:-1,result:o};if(t=a,r-=o.lenBlock.blockLength,!1===o.idBlock.isConstructed&&!0===o.lenBlock.isIndefiniteForm)return o.error="Indefinite length form used for primitive encoding form",{offset:-1,result:o};let u=c;switch(o.idBlock.tagClass){case 1:if(o.idBlock.tagNumber>=37&&!1===o.idBlock.isHexOnly)return o.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:o};switch(o.idBlock.tagNumber){case 0:if(!0===o.idBlock.isConstructed&&o.lenBlock.length>0)return o.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:o};u=m;break;case 1:u=B;break;case 2:u=H;break;case 3:u=N;break;case 4:u=x;break;case 5:u=p;break;case 6:u=E;break;case 10:u=C;break;case 12:u=T;break;case 13:u=P;break;case 14:u=ie;break;case 15:return o.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:o};case 16:u=y;break;case 17:u=b;break;case 18:u=M;break;case 19:u=W;break;case 20:u=$;break;case 21:u=G;break;case 22:u=q;break;case 23:u=X;break;case 24:u=Q;break;case 25:u=z;break;case 26:u=Z;break;case 27:u=Y;break;case 28:u=V;break;case 29:u=K;break;case 30:u=D;break;case 31:u=ee;break;case 32:u=te;break;case 33:u=re;break;case 34:u=ne;break;default:{let n;n=!0===o.idBlock.isConstructed?new d:new f,n.idBlock=o.idBlock,n.lenBlock=o.lenBlock,n.warnings=o.warnings,o=n,a=o.fromBER(e,t,r)}}break;case 2:case 3:case 4:default:u=!0===o.idBlock.isConstructed?d:f}return o=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecode=e.valueBeforeDecode.slice(0),r}(o,u),a=o.fromBER(e,t,!0===o.lenBlock.isIndefiniteForm?r:o.lenBlock.length),o.valueBeforeDecode=e.slice(i,i+o.blockLength),{offset:a,result:o}}function ue(e){if(0===e.byteLength){const e=new c({},Object);return e.error="Input buffer has zero length",{offset:-1,result:e}}return ae(e,0,e.byteLength)}function ce(e,t,r){if(r instanceof se){const n=!1;for(let n=0;n<r.value.length;n++){if(!0===ce(e,t,r.value[n]).verified)return{verified:!0,result:e}}if(!1===n){const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty("name")&&(e.name=r.name),e}}if(r instanceof oe)return r.hasOwnProperty("name")&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if("isHexOnly"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(!0===r.idBlock.isHexOnly){if("valueHex"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=new Uint8Array(r.idBlock.valueHex),i=new Uint8Array(t.idBlock.valueHex);if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(e[r.name]=t)),!0===r.idBlock.isConstructed){let n=0,i={verified:!1},s=r.valueBlock.value.length;if(s>0&&r.valueBlock.value[0]instanceof le&&(s=t.valueBlock.value.length),0===s)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return!0===t?{verified:!0,result:e}:(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let o=0;o<s;o++)if(o-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[o].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof le){if(i=ce(e,t.valueBlock.value[o],r.valueBlock.value[0].value),!1===i.verified){if(!0!==r.valueBlock.value[0].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),i;n++}if("name"in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n="local"in r.valueBlock.value[0]&&!0===r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[o])}}else if(i=ce(e,t.valueBlock.value[o-n],r.valueBlock.value[o]),!1===i.verified){if(!0!==r.valueBlock.value[o].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if("primitiveSchema"in r&&"valueHex"in t.valueBlock){const n=ue(t.valueBlock.valueHex);if(-1===n.offset){const t={verified:!1,result:n.result};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}return ce(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}r.RawData=class{constructor(e={}){this.data=(0,n.getParametersValue)(e,"data",new ArrayBuffer(0))}fromBER(e,t,r){return this.data=e.slice(t,r),t+r}toBER(e=!1){return this.data}}},{pvutils:5}],2:[function(e,t,r){!function(e){"use strict";e.console||(e.console={});for(var t,r,n=e.console,i=function(){},s=["memory"],o="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");t=s.pop();)n[t]||(n[t]={});for(;r=o.pop();)"function"!=typeof n[r]&&(n[r]=i)}("undefined"==typeof window?this:window)},{}],3:[function(e,t,r){(function(n,i){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   3.3.1
 */
!function(e,n){"object"==typeof r&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define(n):e.ES6Promise=n()}(this,(function(){"use strict";function t(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=0,o=void 0,l=void 0,a=function(e,t){v[s]=e,v[s+1]=t,2===(s+=2)&&(l?l(m):p())};var u="undefined"!=typeof window?window:void 0,c=u||{},h=c.MutationObserver||c.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==n&&"[object process]"==={}.toString.call(n),g="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(m,1)}}var v=new Array(1e3);function m(){for(var e=0;e<s;e+=2){(0,v[e])(v[e+1]),v[e]=void 0,v[e+1]=void 0}s=0}var k,B,y,b,p=void 0;function w(e,t){var r=arguments,n=this,i=new this.constructor(N);void 0===i[A]&&F(i);var s,o=n._state;return o?(s=r[o-1],a((function(){return _(o,i,s,n._result)}))):T(n,i,e,t),i}function x(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(N);return L(t,e),t}f?p=function(){return n.nextTick(m)}:h?(B=0,y=new h(m),b=document.createTextNode(""),y.observe(b,{characterData:!0}),p=function(){b.data=B=++B%2}):g?((k=new MessageChannel).port1.onmessage=m,p=function(){return k.port2.postMessage(0)}):p=void 0===u&&"function"==typeof e?function(){try{var t=e("vertx");return o=t.runOnLoop||t.runOnContext,function(){o(m)}}catch(e){return d()}}():d();var A=Math.random().toString(36).substring(16);function N(){}var S=new R;function H(e){try{return e.then}catch(e){return S.error=e,S}}function C(e,r,n){r.constructor===e.constructor&&n===w&&r.constructor.resolve===x?function(e,t){1===t._state?E(e,t._result):2===t._state?U(e,t._result):T(t,void 0,(function(t){return L(e,t)}),(function(t){return U(e,t)}))}(e,r):n===S?U(e,S.error):void 0===n?E(e,r):t(n)?function(e,t,r){a((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?L(e,r):E(e,r))}),(function(t){n||(n=!0,U(e,t))}),e._label);!n&&i&&(n=!0,U(e,i))}),e)}(e,r,n):E(e,r)}function L(e,t){var r;e===t?U(e,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(r=t)||"object"==typeof r&&null!==r?C(e,t,H(t)):E(e,t)}function O(e){e._onerror&&e._onerror(e._result),I(e)}function E(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&a(I,e))}function U(e,t){void 0===e._state&&(e._state=2,e._result=t,a(O,e))}function T(e,t,r,n){var i=e._subscribers,s=i.length;e._onerror=null,i[s]=t,i[s+1]=r,i[s+2]=n,0===s&&e._state&&a(I,e)}function I(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,s=e._result,o=0;o<t.length;o+=3)n=t[o],i=t[o+r],n?_(r,n,i,s):i(s);e._subscribers.length=0}}function R(){this.error=null}var P=new R;function _(e,r,n,i){var s=t(n),o=void 0,l=void 0,a=void 0,u=void 0;if(s){if((o=function(e,t){try{return e(t)}catch(e){return P.error=e,P}}(n,i))===P?(u=!0,l=o.error,o=null):a=!0,r===o)return void U(r,new TypeError("A promises callback cannot return that same promise."))}else o=i,a=!0;void 0!==r._state||(s&&a?L(r,o):u?U(r,l):1===e?E(r,o):2===e&&U(r,o))}var D=0;function F(e){e[A]=D++,e._state=void 0,e._result=void 0,e._subscribers=[]}function V(e,t){this._instanceConstructor=e,this.promise=new e(N),this.promise[A]||F(this.promise),r(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&E(this.promise,this._result))):U(this.promise,new Error("Array Methods must be provided an Array"))}function J(e){this[A]=D++,this._result=this._state=void 0,this._subscribers=[],N!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof J?function(e,t){try{t((function(t){L(e,t)}),(function(t){U(e,t)}))}catch(t){U(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}function j(){var e=void 0;if(void 0!==i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=J}return V.prototype._enumerate=function(){for(var e=this.length,t=this._input,r=0;void 0===this._state&&r<e;r++)this._eachEntry(t[r],r)},V.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===x){var i=H(e);if(i===w&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===J){var s=new r(N);C(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},V.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?U(n,r):this._result[t]=r),0===this._remaining&&E(n,this._result)},V.prototype._willSettleAt=function(e,t){var r=this;T(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},J.all=function(e){return new V(this,e).promise},J.race=function(e){var t=this;return r(e)?new t((function(r,n){for(var i=e.length,s=0;s<i;s++)t.resolve(e[s]).then(r,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},J.resolve=x,J.reject=function(e){var t=new this(N);return U(t,e),t},J._setScheduler=function(e){l=e},J._setAsap=function(e){a=e},J._asap=a,J.prototype={constructor:J,then:w,catch:function(e){return this.then(null,e)}},j(),J.polyfill=j,J.Promise=J,J}))}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:4}],4:[function(e,t,r){var n,i,s=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{i="function"==typeof clearTimeout?clearTimeout:l}catch(e){i=l}}();var u,c=[],h=!1,f=-1;function g(){h&&u&&(h=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!h){var e=a(g);h=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,h=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===l||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function m(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new v(e,t)),1!==c.length||h||a(d)},v.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],5:[function(e,t,r){"use strict";function n(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function i(e,t,r=-1){const n=r;let i=e,s=0,o=Math.pow(2,t);for(let r=1;r<8;r++){if(e<o){let e;if(n<0)e=new ArrayBuffer(r),s=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),s=n}const o=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);o[s-e-1]=Math.floor(i/r),i-=o[s-e-1]*r}return e}o*=Math.pow(2,t)}return new ArrayBuffer(0)}Object.defineProperty(r,"__esModule",{value:!0}),r.getUTCDate=function(e){return new Date(e.getTime()+6e4*e.getTimezoneOffset())},r.getParametersValue=function(e,t,r){return e instanceof Object==!1?r:t in e?e[t]:r},r.bufferToHexCodes=function(e,t=0,r=e.byteLength-t,n=!1){let i="";var s=!0,o=!1,l=void 0;try{for(var a,u=new Uint8Array(e,t,r)[Symbol.iterator]();!(s=(a=u.next()).done);s=!0){const e=a.value.toString(16).toUpperCase();1===e.length&&(i+="0"),i+=e,n&&(i+=" ")}}catch(e){o=!0,l=e}finally{try{!s&&u.return&&u.return()}finally{if(o)throw l}}return i.trim()},r.checkBufferParams=function(e,t,r,n){if(t instanceof ArrayBuffer==!1)return e.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1;if(0===t.byteLength)return e.error="Wrong parameter: inputBuffer has zero length",!1;if(r<0)return e.error="Wrong parameter: inputOffset less than zero",!1;if(n<0)return e.error="Wrong parameter: inputLength less than zero",!1;if(t.byteLength-r-n<0)return e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1;return!0},r.utilFromBase=n,r.utilToBase=i,r.utilConcatBuf=function(...e){let t=0,r=0;var n=!0,i=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){const e=o.value;t+=e.byteLength}}catch(e){i=!0,s=e}finally{try{!n&&l.return&&l.return()}finally{if(i)throw s}}const a=new ArrayBuffer(t),u=new Uint8Array(a);var c=!0,h=!1,f=void 0;try{for(var g,d=e[Symbol.iterator]();!(c=(g=d.next()).done);c=!0){const e=g.value;u.set(new Uint8Array(e),r),r+=e.byteLength}}catch(e){h=!0,f=e}finally{try{!c&&d.return&&d.return()}finally{if(h)throw f}}return a},r.utilConcatView=function(...e){let t=0,r=0;var n=!0,i=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){const e=o.value;t+=e.length}}catch(e){i=!0,s=e}finally{try{!n&&l.return&&l.return()}finally{if(i)throw s}}const a=new ArrayBuffer(t),u=new Uint8Array(a);var c=!0,h=!1,f=void 0;try{for(var g,d=e[Symbol.iterator]();!(c=(g=d.next()).done);c=!0){const e=g.value;u.set(e,r),r+=e.length}}catch(e){h=!0,f=e}finally{try{!c&&d.return&&d.return()}finally{if(h)throw f}}return u},r.utilDecodeTC=function(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const i=n(r,8),s=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(s);for(let t=0;t<this.valueHex.byteLength;t++)o[t]=e[t];o[0]&=127;return n(o,8)-i},r.utilEncodeTC=function(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=i(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let s=i(t,8,n),o=new Uint8Array(s);if(128&o[0]){const e=s.slice(0),t=new Uint8Array(e);s=new ArrayBuffer(s.byteLength+1),o=new Uint8Array(s);for(let r=0;r<e.byteLength;r++)o[r+1]=t[r];o[0]=0}return s}r*=Math.pow(2,8)}return new ArrayBuffer(0)},r.isEqualBuffer=function(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0},r.padNumber=function(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)},r.toBase64=function(e,t=!1,r=!1,n=!1){let i=0,l=0,a=0,u="";const c=t?o:s;if(n){let t=0;for(let r=0;r<e.length;r++)if(0!==e.charCodeAt(r)){t=r;break}e=e.slice(t)}for(;i<e.length;){const t=e.charCodeAt(i++);i>=e.length&&(l=1);const n=e.charCodeAt(i++);i>=e.length&&(a=1);const s=e.charCodeAt(i++),o=t>>2,h=(3&t)<<4|n>>4;let f=(15&n)<<2|s>>6,g=63&s;1===l?f=g=64:1===a&&(g=64),u+=r?64===f?`${c.charAt(o)}${c.charAt(h)}`:64===g?`${c.charAt(o)}${c.charAt(h)}${c.charAt(f)}`:`${c.charAt(o)}${c.charAt(h)}${c.charAt(f)}${c.charAt(g)}`:`${c.charAt(o)}${c.charAt(h)}${c.charAt(f)}${c.charAt(g)}`}return u},r.fromBase64=function(e,t=!1,r=!1){const n=t?o:s;function i(e){for(let t=0;t<64;t++)if(n.charAt(t)===e)return t;return 64}function l(e){return 64===e?0:e}let a=0,u="";for(;a<e.length;){const t=i(e.charAt(a++)),r=a>=e.length?0:i(e.charAt(a++)),n=a>=e.length?0:i(e.charAt(a++)),s=a>=e.length?0:i(e.charAt(a++)),o=l(t)<<2|l(r)>>4,c=(15&l(r))<<4|l(n)>>2,h=(3&l(n))<<6|l(s);u+=String.fromCharCode(o),64!==n&&(u+=String.fromCharCode(c)),64!==s&&(u+=String.fromCharCode(h))}if(r){const e=u.length;let t=-1;for(let r=e-1;r>=0;r--)if(0!==u.charCodeAt(r)){t=r;break}u=-1!==t?u.slice(0,t+1):""}return u},r.arrayBufferToString=function(e){let t="";const r=new Uint8Array(e);var n=!0,i=!1,s=void 0;try{for(var o,l=r[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){const e=o.value;t+=String.fromCharCode(e)}}catch(e){i=!0,s=e}finally{try{!n&&l.return&&l.return()}finally{if(i)throw s}}return t},r.stringToArrayBuffer=function(e){const t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return r},r.nearestPowerOf2=function(e){const t=Math.log(e)/l,r=Math.floor(t),n=Math.round(t);return r===n?r:n},r.clearProps=function(e,t){var r=!0,n=!1,i=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done);r=!0){const t=s.value;delete e[t]}}catch(e){n=!0,i=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw i}}};const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";const l=Math.log(2)},{}],6:[function(e,t,r){var n=function(e){function t(e){return!!(e&&e.call&&e.apply)}function r(e,r){return t(e[r])?function(){return e[r].apply(e,arguments)}:e[r]}function n(e){return function(){return e}}function i(){e.ready=Promise.resolve(!0),e.isExtensionInstalled=n(Promise.resolve(!1)),e.isPluginInstalled=n(Promise.resolve(!0)),e.loadPlugin=s,window.rutokenLoaded=l}function s(){var e=document.createElement("object");return e.style.setProperty("visibility","hidden","important"),e.style.setProperty("width","0px","important"),e.style.setProperty("height","0px","important"),e.style.setProperty("margin","0px","important"),e.style.setProperty("padding","0px","important"),e.style.setProperty("border-style","none","important"),e.style.setProperty("border-width","0px","important"),e.style.setProperty("max-width","0px","important"),e.style.setProperty("max-height","0px","important"),e.innerHTML="<param name='onload' value='rutokenLoaded'/>",e.setAttribute("type",f),document.body.appendChild(e),new Promise((function(e,t){h.push(e)}))}function o(){return g.loadPlugin().then((function(e){return function e(n){var i={},s=[];for(var o in n)!function(o){t(n[o].then)?s.push(n[o].then((function(s){return e(s).then((function(e){t(e)?i[o]=r(n,o):i[o]=e}))}))):i[o]=n[o]}(o);return 0==s.length?new Promise((function(e){e(n)})):Promise.all(s).then((function(){return i}))}(e)})).then((function(e){return e.wrapWithOldInterface=a,e}))}function l(e,t){c(e).then((function(e){if(0==h.length)throw"Internal error";h.shift()(e)}))}function a(){var e={};for(var r in this)t(this[r])?e[r]=function(e,t){return function(){var r=arguments[arguments.length-2],n=arguments[arguments.length-1],i=Array.prototype.slice.call(arguments,0,-2);return t.apply(e,i).then((function(e){r(e)}),(function(e){n(e.message)}))}}(this,this[r]):e[r]=this[r];return new Promise((function(t){t(e)}))}function u(){var e={originalObject:this.originalObject};for(var t in this.originalObject)e[t]=r(this.originalObject,t);return new Promise((function(t){t(e)}))}function c(e){var r={originalObject:e,wrapWithOldInterface:u};for(var n in e)t(e[n])?r[n]=function(e,t){return function(){var r=Array.prototype.slice.call(arguments);return new Promise((function(n,i){r.push(n,i),t.apply(e,r)}))}}(e,e[n]):r[n]=e[n];return new Promise((function(e){e(r)}))}var h=[],f="application/x-rutoken-pki",g=window["C3B7563B-BF85-45B7-88FC-7CFF1BD3C2DB"];if(g)!function(){var t=g.initialize().then((function(){return g.isPluginInstalled()})).then((function(t){return e.isExtensionInstalled=n(Promise.resolve(!0)),e.isPluginInstalled=r(g,"isPluginInstalled"),t&&(f="application/x-rutoken-plugin",e.loadPlugin=o),!0}));e.ready=t}();else if(navigator.mimeTypes&&navigator.mimeTypes[f])i();else try{new ActiveXObject("Aktiv.CryptoPlugin"),i()}catch(t){e.ready=Promise.resolve(!0),e.isExtensionInstalled=n(Promise.resolve(!1)),e.isPluginInstalled=n(Promise.resolve(!1))}return e}(n||{});void 0!==t&&(t.exports=n)},{}],7:[function(e,t,r){(function(t){e("es6-promise").polyfill(),e("console-polyfill"),t.rutoken=e("rutoken"),t.asn1js=e("asn1js")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{asn1js:1,"console-polyfill":2,"es6-promise":3,rutoken:6}]},{},[7]);